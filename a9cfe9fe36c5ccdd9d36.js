const{set:set}=require("core-js/core/dict");function onNewMessageComposeHandler(e){console.log("NEW MESSAGE COMPOSE HANDLER"),setSubject(e),setSignature(e)}function onNewAppointmentComposeHandler(e){setSubject(e)}function onMessageFromChangedHandler(e){console.log("FROM CHANGED HANDLER"),setSignature(e)}function action(e){setSignature(e)}function setSubject(e){Office.context.mailbox.item.subject.setAsync("Set by an event-based add-in!",{asyncContext:e},(function(e){e.status!==Office.AsyncResultStatus.Succeeded&&console.error("Failed to set subject: "+JSON.stringify(e.error)),e.asyncContext.completed()}))}function setSignature(e){const t=Office.context.mailbox.userProfile.emailAddress;fetch("http://172.205.208.217:3001/podpis",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t})}).then((e=>e.text())).then((t=>{Office.context.mailbox.item.body.setSignatureAsync(t,{coercionType:Office.CoercionType.Html},(function(t){t.status!==Office.AsyncResultStatus.Succeeded&&console.error("Failed to set signature: "+JSON.stringify(t.error)),e.completed()}))})).catch((t=>{console.error("Napaka pri pridobivanju podpisa: "+t),e.completed()}))}Office.actions.associate("onNewMessageComposeHandler",onNewMessageComposeHandler),Office.actions.associate("onMessageFromChangedHandler",onMessageFromChangedHandler),Office.actions.associate("onNewAppointmentComposeHandler",onNewAppointmentComposeHandler),Office.actions.associate("action",action);